# PROTEINS Graph Classification configuration

data:
  name: PROTEINS
  root: ${oc.env:HOME}/.cache/energy-transformer/data
  # PROTEINS specific settings
  max_num_nodes: 620  # Max nodes in PROTEINS dataset
  batch_size: 8   # Further reduced for memory
  use_node_attr: true
  cleaned: false
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1
  pos_encoding_method: eigen
  num_workers: 0

model:
  input_dim: 4    # PROTEINS has 4D node features
  out_dim: 2      # Binary classification
  embed_dim: 64   # Further reduced to save memory
  num_heads: 4    # Keep 4 heads
  qk_dim: 8       # Further reduced to save memory
  pos_encoding_dim: 8  # Reduced positional encoding
  num_layers: 1
  mlp_ratio: 2.0  # Reduced MLP ratio
  num_time_steps: 3  # Fewer time steps
  step_size: 1.0
  norm_eps: 1e-6
  attn_bias: false
  mlp_bias: false
  hopfield_activation_type: softmax  # Use Softmax/LogSumExp activation

train:
  epochs: 300
  optimizer:
    lr: 3e-4
    weight_decay: 0.0001
  gradient_clip: 1.0
  gradient_accumulation_steps: 2  # Accumulate gradients over 2 steps
  scheduler:
    enabled: false

# Misc
seed: 3407
save_interval: 10
checkpoint_dir: checkpoints/${data.name}
result_dir: results/${data.name}
visualization_dir: visualizations/${data.name}

# Hydra configuration
hydra:
  run:
    dir: outputs/${data.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: multirun/${data.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
  job:
    chdir: true