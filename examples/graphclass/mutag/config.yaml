# MUTAG Graph Classification configuration

data:
  name: MUTAG
  root: ${oc.env:HOME}/.cache/energy-transformer/data
  # MUTAG specific settings
  max_num_nodes: 28  # Max nodes in MUTAG dataset
  batch_size: 16     # Smaller batch size for more updates per epoch
  use_node_attr: true
  cleaned: false
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1
  pos_encoding_method: eigen
  num_workers: 0

model:
  input_dim: 12   # MUTAG has 7D node features + 5D degree features
  out_dim: 2     # Binary classification
  embed_dim: 128 # Smaller model for smaller dataset
  num_heads: 8
  qk_dim: 32
  pos_encoding_dim: 8
  num_layers: 1
  mlp_ratio: 4.0
  num_time_steps: 5
  step_size: 1.0
  norm_eps: 1e-6
  attn_bias: false
  mlp_bias: false
  dropout: 0.1
  pooling: cls
  hopfield_activation_type: manhattan  # Use Manhattan distance activation

train:
  epochs: 300  # More epochs for small dataset
  optimizer:
    lr: 1e-3  # Higher learning rate
    weight_decay: 0.0001
  gradient_clip: 1.0
  scheduler:
    enabled: true
    warmup_epochs: 50
    eta_min: 5e-6

# Misc
seed: 3407
save_interval: 10
checkpoint_dir: checkpoints/${data.name}
result_dir: results/${data.name}
visualization_dir: visualizations/${data.name}

# Hydra configuration
hydra:
  run:
    dir: outputs/${data.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: multirun/${data.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
  job:
    chdir: true